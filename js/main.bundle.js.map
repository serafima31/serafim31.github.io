{"version":3,"sources":["webpack://keksobooking/./source/js/util.js","webpack://keksobooking/./source/js/api.js","webpack://keksobooking/./source/js/filter.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/similar-card.js","webpack://keksobooking/./source/js/pictures-load.js","webpack://keksobooking/./source/js/form.js"],"names":["isEscEvent","evt","key","URL_DATA","getData","url","onSuccess","onError","fetch","then","response","ok","json","Error","status","catch","err","HOUSE_TYPE_SETTINGS","0","1","2","3","4","ROOMS_SETTINGS","GUEST_SETTINGS","filtersForm","document","querySelector","filterHouseType","filterPrice","filterRooms","filterGuests","filterFeaturesList","minNumberOfRooms","minNumberOfGuest","push","changeElement","cb","addEventListener","adForm","allFieldset","querySelectorAll","mapFilters","mapFilterChildren","children","mapFilterItems","Array","from","addressValue","mainCoordinateLat","mainCoordinateLng","showError","filterItem","message","alertContainer","createElement","style","zIndex","position","left","top","right","padding","fontSize","textAlign","backgroundColor","textContent","body","append","setTimeout","remove","showAlert","classList","add","forEach","el","disabled","filters","fieldsets","goToInactiveState","layerGroup","L","createAdMarkers","offersList","slice","filter","checkHouseType","object","selectedIndex","includes","offer","type","price","checkPrice","rooms","checkRooms","guests","checkGuests","every","item","features","some","feature","value","checkFeatures","offersItem","pinIcon","icon","iconUrl","iconSize","iconAnchor","marker","lat","location","lng","addTo","bindPopup","card","content","cloneNode","offerTitle","offerAddress","offerPrice","offerType","offerCapacity","offerTime","offerFeatures","featureList","offerDescription","offerPhotos","offerAvatar","title","address","checkin","checkout","featureFragment","createDocumentFragment","innerHTML","length","offerFeatureItem","appendChild","description","photosFragment","photoSrc","photos","i","offerPhotoItem","width","height","src","author","avatar","createAdCard","keepInView","map","on","goToActiveState","readOnly","offers","_","debounce","clearLayers","setView","tileLayer","attribution","mainPinIcon","mainMarker","draggable","coordinateValue","target","getLatLng","coordinateLat","coordinateLng","toFixed","FILE_TYPES","loadImg","input","preview","file","files","fileName","name","toLowerCase","endsWith","reader","FileReader","result","readAsDataURL","resetPreviewImg","imageSrc","DEFAULT_SRC_IMAGE","GUESTS_IN_ROOMS","main","housingType","priceForNight","timeIn","timeOut","formElementTime","headlineInput","roomsInput","guestsInput","resetFormBtn","avatarFileChooser","avatarPreview","imgFileChoicer","imgPreview","successPopup","errorPopup","errorButton","placeholder","min","valueLength","setCustomValidity","reportValidity","onRoomsGuests","resetForm","reset","setLatLng","onWindowClickSuccesPopup","window","removeEventListener","onSuccesPopupEscKeydown","preventDefault","showSuccess","onWindowErrorPopupClick","onErrorPopupEscKeydown","onErrorButtonClick","data","FormData","method"],"mappings":"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","file":"main.bundle.js","sourcesContent":["const ALERT_SHOW_TIME = 5000;\n\nconst getRandomIntNumber = (bottom, top) => {\n  const min = Math.ceil(Math.min(bottom, top));\n  const max = Math.floor(Math.max(bottom, top));\n  const result = Math.abs(Math.floor(Math.random() * (max - min + 1)) + min); //Максимум и минимум включаются\n  return result;\n};\n\nconst getRandomFloatNumber = (bottom, top, roundUp = 5) => {\n  const min = Math.min(bottom, top);\n  const max = Math.max(bottom, top);\n  const result = Math.abs(Math.random() * (max - min) + min); //Максимум и минимум включаются\n  return result.toFixed(roundUp);\n};\n\nconst getRandomArrayElement = (elements) => {\n  return elements[getRandomIntNumber(0, elements.length - 1)];\n};\n\nconst getNoRepeatElements = (elements) => {\n  return elements.filter(() => Math.random() > 0.5);\n};\n\nconst goToInactiveState = (filters, adForm, fieldsets, filterItem) => {\n  filters.classList.add('map__filters--disabled');\n  adForm.classList.add('ad-form--disabled');\n\n  fieldsets.forEach((el) => {\n    el.disabled = true;\n  });\n\n  filterItem.forEach((el) => {\n    el.disabled = true;\n  });\n};\n\nconst goToInactiveFiltersState = (filters, filterItem) => {\n  filters.classList.add('map__filters--disabled');\n  filterItem.forEach((el) => {\n    el.disabled = true;\n  });\n}\n\nconst goToActiveState = (filters, adForm, fieldsets, filterItem) => {\n  filters.classList.remove('map__filters--disabled');\n  adForm.classList.remove('ad-form--disabled');\n\n  fieldsets.forEach((el) => {\n    el.disabled = false;\n  });\n\n  filterItem.forEach((el) => {\n    el.disabled = false;\n  });\n};\n\nconst showAlert = (message) => {\n  const alertContainer = document.createElement('div');\n  alertContainer.style.zIndex = 1000;\n  alertContainer.style.position = 'fixed';\n  alertContainer.style.left = 0;\n  alertContainer.style.top = 0;\n  alertContainer.style.right = 0;\n  alertContainer.style.padding = '10px 3px';\n  alertContainer.style.fontSize = '30px';\n  alertContainer.style.textAlign = 'center';\n  alertContainer.style.backgroundColor = 'red';\n  alertContainer.textContent = message;\n\n  document.body.append(alertContainer);\n\n  setTimeout(() => {\n    alertContainer.remove();\n  }, ALERT_SHOW_TIME);\n}\n\nconst isEscEvent = (evt) => {\n  return evt.key === 'Escape' || evt.key === 'Esc';\n};\n\nexport {\n  getRandomIntNumber,\n  getRandomFloatNumber,\n  getRandomArrayElement,\n  getNoRepeatElements,\n  goToInactiveState,\n  goToActiveState,\n  goToInactiveFiltersState,\n  showAlert,\n  isEscEvent\n};\n","const URL_DATA = './db/log.json';\nconst URL_SERVER = 'https://22.javascript.pages.academy/keksobooking';\n\nconst getData = (url, onSuccess, onError) => {\n  return fetch(url)\n    .then((response) => {\n      if (response.ok) {\n        return response.json();\n      }\n\n      throw new Error(`${response.status}`);\n    })\n    .then((json) => {\n      onSuccess(json);\n    })\n    .catch((err) => {\n      onError(err);\n    });\n}\n\nconst sendData = (url, onSuccess, onError, body) => {\n  fetch(url, {\n    method: 'POST',\n    body,\n  })\n    .then((response) => {\n      if (response.ok) {\n        onSuccess();\n      } else {\n        onError();\n      }\n    })\n    .catch(() => {\n      onError();\n    })\n}\n\nexport {\n  getData,\n  sendData,\n  URL_SERVER,\n  URL_DATA\n}\n","const LOWER_PRICE_RANGE = 0;\nconst UPPER_PRICE_RANGE = 50000;\nconst MIDDLE_PRICE_RANGE = 10000;\n\nconst HOUSE_TYPE_SETTINGS = {\n  0: ['flat', 'palace', 'house', 'bungalow'],\n  1: ['palace'],\n  2: ['flat'],\n  3: ['house'],\n  4: ['bungalow'],\n};\n\nconst ROOMS_SETTINGS = {\n  0: [],\n  1: [1],\n  2: [2],\n  3: [3],\n};\n\nconst GUEST_SETTINGS = {\n  0: [],\n  1: [2],\n  2: [1],\n  3: [0],\n};\nconst maxLimit = 150;\n\nconst filtersForm = document.querySelector('.map__filters');\nconst filterHouseType = document.querySelector('#housing-type');\nconst filterPrice = document.querySelector('#housing-price');\nconst filterRooms = document.querySelector('#housing-rooms');\nconst filterGuests = document.querySelector('#housing-guests');\nconst filterFeaturesList = document.querySelector('#housing-features');\n\nlet minNumberOfRooms = 0;\nlet minNumberOfGuest = 0;\n\nwhile(minNumberOfRooms <= maxLimit) {\n  ROOMS_SETTINGS[0].push(minNumberOfRooms++);\n}\n\nwhile(minNumberOfGuest <= maxLimit) {\n  GUEST_SETTINGS[0].push(minNumberOfGuest++);\n}\n\nconst checkHouseType = (object) => HOUSE_TYPE_SETTINGS[filterHouseType.selectedIndex].includes(object.offer.type);\n\nconst checkPrice = (object) => {\n  switch (filterPrice.selectedIndex) {\n    case 0:\n      return (object.offer.price >= LOWER_PRICE_RANGE);\n    case 1:\n      return (object.offer.price >= MIDDLE_PRICE_RANGE && object.offer.price <= UPPER_PRICE_RANGE);\n    case 2:\n      return (object.offer.price < MIDDLE_PRICE_RANGE && object.offer.price >= LOWER_PRICE_RANGE);\n    case 3:\n      return (object.offer.price > UPPER_PRICE_RANGE);\n  }\n};\n\nconst checkRooms = (object) => ROOMS_SETTINGS[filterRooms.selectedIndex].includes(object.offer.rooms);\n\nconst checkGuests = (object) => GUEST_SETTINGS[filterGuests.selectedIndex].includes(object.offer.guests);\n\nconst changeElement = (cb) => {\n  filtersForm.addEventListener('change', () => {\n    cb();\n  })\n};\n\nconst checkFeatures = (object) => {\n  const checkedFeatures = Array.from(filterFeaturesList.querySelectorAll('input:checked'));\n  return checkedFeatures.every((item) => {\n    return object.offer.features.some((feature) => {\n      return feature === item.value;\n    });\n  });\n};\n\nexport {\n  checkHouseType,\n  checkPrice,\n  changeElement,\n  checkRooms,\n  checkGuests,\n  checkFeatures\n};\n","/* global L:readonly */\n/* global _:readonly */\nimport {\n  goToInactiveState,\n  goToActiveState,\n  goToInactiveFiltersState,\n  showAlert\n} from './util.js';\nimport { createAdCard } from './similar-card.js';\nimport {\n  getData,\n  URL_DATA\n} from './api.js';\nimport {\n  checkHouseType,\n  checkPrice,\n  checkRooms,\n  changeElement,\n  checkGuests,\n  checkFeatures\n} from './filter.js';\n\nconst ROUND_UP = 5;\nconst MAP_SIZE = 13;\nconst PIN_SIZE = 42;\nconst MIDDLE_PIN_SIZE = 21;\nconst MAIN_PIN_SIZE = 52;\nconst MIDDLE_MAIN_PIN_SIZE = 26;\nconst OFFERS_COUNT = 10;\nconst FIRS_OFFERS_POSITION = 0;\nconst DEBOUNSE_DELAY = 500;\n\nconst adForm = document.querySelector('.ad-form');\nconst allFieldset = adForm.querySelectorAll('fieldset');\nconst mapFilters = document.querySelector('.map__filters');\nconst mapFilterChildren = mapFilters.children;\nconst mapFilterItems = Array.from(mapFilterChildren);\nconst addressValue = document.querySelector('#address');\nconst mainCoordinateLat = 35.68331;\nconst mainCoordinateLng = 139.7631;\n\nconst showError = () => {\n  showAlert('Данные объявлений не загружены, попробуйте позже')\n  goToInactiveFiltersState(mapFilters, mapFilterItems);\n};\n\ngoToInactiveState(mapFilters, adForm, allFieldset, mapFilterItems);\n\nconst layerGroup = L.layerGroup();\n\nconst createAdMarkers = (offersList) => {\n  offersList\n    .slice()\n    .filter((el) => checkHouseType(el) && checkPrice(el) && checkRooms(el) && checkGuests(el) && checkFeatures(el))\n    .slice(FIRS_OFFERS_POSITION, OFFERS_COUNT)\n    .forEach((offersItem) => {\n      const pinIcon = L.icon({\n        iconUrl: './img/pin.svg',\n        iconSize: [PIN_SIZE, PIN_SIZE],\n        iconAnchor: [MIDDLE_PIN_SIZE, PIN_SIZE],\n      });\n      const marker = L.marker(\n        {\n          lat: offersItem.location.lat,\n          lng: offersItem.location.lng,\n        },\n        {\n          icon: pinIcon,\n        },\n      );\n\n      marker\n        .addTo(layerGroup)\n        .bindPopup(createAdCard(offersItem), {\n          keepInView: true,\n        });\n\n      layerGroup.addTo(map);\n    });\n};\n\nconst resetMarkers = () => {\n  layerGroup.remove();\n  getData(\n    URL_DATA,\n    (offers) => {\n      createAdMarkers(offers);\n      changeElement(_.debounce(\n        () => {\n          layerGroup.clearLayers();\n          createAdMarkers(offers);\n        }, DEBOUNSE_DELAY))\n    },\n    showError,\n  );\n}\n\nconst map = L.map('map-canvas')\n  .on('load', () => {\n    goToActiveState(mapFilters, adForm, allFieldset, mapFilterItems);\n    addressValue.readOnly = true;\n    addressValue.value = `${mainCoordinateLat}, ${mainCoordinateLng}`;\n    getData(\n      URL_DATA,\n      (offers) => {\n        createAdMarkers(offers);\n        changeElement(_.debounce(\n          () => {\n            layerGroup.clearLayers();\n            createAdMarkers(offers);\n          }, DEBOUNSE_DELAY))\n      },\n      showError,\n    );\n  })\n  .setView(\n    {\n      lat: mainCoordinateLat,\n      lng: mainCoordinateLng,\n    }, MAP_SIZE);\n\nL.tileLayer(\n  'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n  {\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors | Icons made by <a href=\"https://www.freepik.com\" title=\"Freepik\">Freepik</a> from <a href=\"https://www.flaticon.com/\" title=\"Flaticon\">www.flaticon.com</a>',\n  },\n).addTo(map);\n\nconst mainPinIcon = L.icon({\n  iconUrl: './img/main-pin.svg',\n  iconSize: [MAIN_PIN_SIZE, MAIN_PIN_SIZE],\n  iconAnchor: [MIDDLE_MAIN_PIN_SIZE, MAIN_PIN_SIZE],\n});\n\nconst mainMarker = L.marker(\n  {\n    lat: mainCoordinateLat,\n    lng: mainCoordinateLng,\n  },\n  {\n    draggable: true,\n    icon: mainPinIcon,\n  },\n);\n\nmainMarker.addTo(map);\n\nmainMarker.on('moveend', (evt) => {\n  const coordinateValue = evt.target.getLatLng();\n  let coordinateLat = coordinateValue.lat;\n  let coordinateLng = coordinateValue.lng;\n  addressValue.value = `${coordinateLat.toFixed(ROUND_UP)}, ${coordinateLng.toFixed(ROUND_UP)}`;\n});\n\nexport {\n  mainMarker,\n  mainCoordinateLat,\n  mainCoordinateLng,\n  resetMarkers\n}\n","const createAdCard = (offersItem) => {\n  const cardTemplate = document.querySelector('#card').content;\n  const newCardTemplate = cardTemplate.querySelector('.popup');\n  const card = newCardTemplate.cloneNode(true);\n\n  const offerTitle = card.querySelector('.popup__title');\n  const offerAddress = card.querySelector('.popup__text--address');\n  const offerPrice = card.querySelector('.popup__text--price');\n  const offerType = card.querySelector('.popup__type');\n  const offerCapacity = card.querySelector('.popup__text--capacity');\n  const offerTime = card.querySelector('.popup__text--time');\n  const offerFeatures = card.querySelector('.popup__features');\n  const featureList = offersItem.offer.features;\n  const offerDescription = card.querySelector('.popup__description');\n  const offerPhotos = card.querySelector('.popup__photos');\n  const offerAvatar = card.querySelector('.popup__avatar');\n\n  offerTitle.textContent = offersItem.offer.title;\n  offerAddress.textContent = offersItem.offer.address; // Вывод координат\n  offerPrice.textContent = offersItem.offer.price + ' ₽/ночь';\n\n  switch (offersItem.offer.type) {\n    case 'palace':\n      offerType.textContent = 'Дворец';\n      break;\n    case 'flat':\n      offerType.textContent = 'Квартира';\n      break;\n    case 'house':\n      offerType.textContent = 'Дом';\n      break;\n    case 'bungalow':\n      offerType.textContent = 'Бунгало';\n      break;\n  }\n\n  offerCapacity.textContent = offersItem.offer.rooms + ' комнаты для ' + offersItem.offer.guests + ' гостей'; // Вывод типа жилья, проверенный чз switch\n  offerTime.textContent = 'Заезд после ' + offersItem.offer.checkin + ', выезд до ' + offersItem.offer.checkout;\n\n  const featureFragment = document.createDocumentFragment();\n  offerFeatures.innerHTML = ''; // Очистил в шаблоне контейнер с 'удобствами'\n\n  if (featureList.length === 0) {\n    offerFeatures.classList.add('hidden');\n  }\n\n  featureList.forEach((feature) => {\n    // Вывод фич в очищенный контейнер\n    const offerFeatureItem = document.createElement('li');\n    offerFeatureItem.classList.add('popup__feature', 'popup__feature--' + feature);\n    featureFragment.appendChild(offerFeatureItem);\n    offerFeatures.appendChild(featureFragment)\n  });\n\n  offerDescription.textContent = offersItem.offer.description;\n\n  const photosFragment = document.createDocumentFragment();\n  offerPhotos.innerHTML = ''; // Очистил в шаблоне контейнер с фотографиями жилья\n  const photoSrc = offersItem.offer.photos;\n\n  for (let i = 0; i < photoSrc.length; i++) {\n    // Вывод фотографий в очищенный контейнер\n    const offerPhotoItem = document.createElement('img');\n    offerPhotoItem.classList.add('popup__photo');\n    offerPhotoItem.width = 40;\n    offerPhotoItem.height = 40;\n    offerPhotoItem.src = photoSrc[i];\n    photosFragment.appendChild(offerPhotoItem);\n    offerPhotos.appendChild(photosFragment);\n  }\n\n  offerAvatar.src = offersItem.author.avatar;\n\n  return card;\n};\n\nexport { createAdCard };\n","const FILE_TYPES = ['gif', 'jpg', 'jpeg', 'png', 'svg'];\n\nconst loadImg = (input, preview) => {\n  input.addEventListener('change', () => {\n    const file = input.files[0];\n    const fileName = file.name.toLowerCase();\n\n    const matches = FILE_TYPES.some((item) => {\n      return fileName.endsWith(item);\n    });\n\n    if (matches) {\n      const reader = new FileReader();\n\n      reader.addEventListener('load', () => {\n        preview.src = reader.result;\n      });\n\n      reader.readAsDataURL(file);\n    }\n  })\n}\n\nconst resetPreviewImg = (preview, imageSrc) => {\n  preview.src = imageSrc;\n}\n\nexport { loadImg, resetPreviewImg }\n","import {\n  sendData,\n  URL_SERVER\n} from './api.js';\nimport {\n  mainMarker,\n  mainCoordinateLat,\n  mainCoordinateLng,\n  resetMarkers\n} from './map.js';\nimport {\n  loadImg,\n  resetPreviewImg\n} from './pictures-load.js';\nimport { isEscEvent } from './util.js';\n\nconst PALACE_MIN_PRICE = 10000;\nconst FLAT_MIN_PRICE = 1000;\nconst HOUSE_MIN_PRICE = 5000;\nconst BUNGALOW_MIN_PRICE = 0;\nconst DEFAULT_SRC_IMAGE = 'img/muffin-grey.svg';\nconst MIN_HEADLINE_LENGTH = 30;\nconst MAX_HEADLINE_LENGTH = 100;\nconst GUESTS_IN_ROOMS = { // Соответствие комнат и гостей по индексам\n  0: [2],\n  1: [1, 2],\n  2: [0, 1, 2],\n  3: [3],\n};\n\nconst main = document.querySelector('main');\nconst filtersForm = document.querySelector('.map__filters');\nconst adForm = document.querySelector('.ad-form');\nconst housingType = adForm.querySelector('#type');\nconst priceForNight = adForm.querySelector('#price');\nconst addressValue = adForm.querySelector('#address');\nconst timeIn = adForm.querySelector('#timein');\nconst timeOut = adForm.querySelector('#timeout');\nconst formElementTime = adForm.querySelector('.ad-form__element--time');\nconst headlineInput = adForm.querySelector('#title');\nconst roomsInput = adForm.querySelector('#room_number');\nconst guestsInput = adForm.querySelector('#capacity');\nconst resetFormBtn = adForm.querySelector('.ad-form__reset');\n\nconst avatarFileChooser = adForm.querySelector('.ad-form__field input[type=file]');\nconst avatarPreview = adForm.querySelector('.ad-form-header__preview img');\nconst imgFileChoicer = adForm.querySelector('.ad-form__upload input[type=file]');\nconst imgPreview = adForm.querySelector('.ad-form__photo-preview');\n\nconst successTemplate = document.querySelector('#success ').content;\nconst newSuccessTemplate = successTemplate.querySelector('.success');\nconst successPopup = newSuccessTemplate.cloneNode(true);\n\nconst errorTemplate = document.querySelector('#error').content;\nconst newErrorTemplate = errorTemplate.querySelector('.error')\nconst errorPopup = newErrorTemplate.cloneNode(true);\nconst errorButton = errorPopup.querySelector('.error__button');\n\nhousingType.addEventListener('change', (evt) => {\n  switch (evt.target.value) {\n    case 'palace':\n      priceForNight.value = '';\n      priceForNight.placeholder = PALACE_MIN_PRICE;\n      priceForNight.min = PALACE_MIN_PRICE;\n      break;\n    case 'flat':\n      priceForNight.value = '';\n      priceForNight.placeholder = FLAT_MIN_PRICE;\n      priceForNight.min = FLAT_MIN_PRICE;\n      break;\n    case 'house':\n      priceForNight.value = '';\n      priceForNight.placeholder = HOUSE_MIN_PRICE;\n      priceForNight.min = HOUSE_MIN_PRICE;\n      break;\n    case 'bungalow':\n      priceForNight.value = '';\n      priceForNight.placeholder = BUNGALOW_MIN_PRICE;\n      priceForNight.min = BUNGALOW_MIN_PRICE;\n      break;\n  }\n});\n\nformElementTime.addEventListener('change', (evt) => {\n  timeIn.value = evt.target.value;\n  timeOut.value = evt.target.value;\n});\n\nheadlineInput.addEventListener('input', (evt) => {\n  const valueLength = evt.target.value.valueLength;\n\n  if (valueLength < MIN_HEADLINE_LENGTH) {\n    headlineInput.setCustomValidity('Еще ' + (MIN_HEADLINE_LENGTH - valueLength) +' симв.');\n  } else if (valueLength > MAX_HEADLINE_LENGTH) {\n    headlineInput.setCustomValidity('Удалите лишние ' + (valueLength - MAX_HEADLINE_LENGTH) +' симв.');\n  } else {\n    headlineInput.setCustomValidity('');\n  }\n  headlineInput.reportValidity();\n});\n\nconst checkGuestsInRooms = () => {\n  return GUESTS_IN_ROOMS[roomsInput.selectedIndex].includes(guestsInput.selectedIndex);\n}\n\n\nconst onRoomsGuests = (evt) => {\n  const valid = checkGuestsInRooms();\n  if(valid) {\n    evt.target.setCustomValidity('')\n  } else {\n    evt.target.setCustomValidity('Проверьте данные')\n  }\n  if (roomsInput.selectedIndex === 3 && guestsInput.selectedIndex === 3) {\n    roomsInput.setCustomValidity('')\n    guestsInput.setCustomValidity('')\n  }\n  evt.target.reportValidity();\n}\n\nroomsInput.addEventListener('change', onRoomsGuests);\nguestsInput.addEventListener('change', onRoomsGuests);\n\nconst resetForm = () => {\n  adForm.reset();\n  filtersForm.reset();\n  resetMarkers();\n  resetPreviewImg(avatarPreview, DEFAULT_SRC_IMAGE);\n  resetPreviewImg(imgPreview, DEFAULT_SRC_IMAGE);\n  addressValue.value = `${mainCoordinateLat}, ${mainCoordinateLng}`;\n  mainMarker.setLatLng([mainCoordinateLat, mainCoordinateLng]);\n  housingType.value = 'flat';\n  priceForNight.value = '';\n  priceForNight.placeholder = '1000';\n  timeIn.value = '12:00';\n  timeOut.value = '12:00';\n  roomsInput.value = '1';\n  guestsInput.value = '1';\n};\n\nconst onWindowClickSuccesPopup = () => {\n  successPopup.remove()\n  window.removeEventListener('click', onWindowClickSuccesPopup);\n  window.removeEventListener('keydown', onSuccesPopupEscKeydown);\n};\n\nconst onSuccesPopupEscKeydown = (evt) => {\n  if (isEscEvent) {\n    evt.preventDefault();\n    successPopup.remove();\n    window.removeEventListener('keydown', onSuccesPopupEscKeydown);\n    window.removeEventListener('click', onWindowClickSuccesPopup);\n  }\n};\n\nconst showSuccess = () => {\n  resetForm();\n  main.appendChild(successPopup);\n  window.addEventListener('click', onWindowClickSuccesPopup);\n  window.addEventListener('keydown', onSuccesPopupEscKeydown);\n};\n\nconst onWindowErrorPopupClick = () => {\n  errorPopup.remove();\n  window.removeEventListener('click', onWindowErrorPopupClick);\n  window.removeEventListener('keydown', onErrorPopupEscKeydown);\n};\n\nconst onErrorPopupEscKeydown = () => {\n  if (isEscEvent) {\n    errorPopup.remove();\n    window.removeEventListener('keydown', onErrorPopupEscKeydown);\n    window.removeEventListener('click', onWindowErrorPopupClick);\n  }\n};\n\nconst onErrorButtonClick = () => {\n  errorPopup.remove();\n  errorButton.removeEventListener('click', onErrorButtonClick);\n};\n\nconst showError = () => {\n  main.appendChild(errorPopup);\n  window.addEventListener('click', onWindowErrorPopupClick);\n  window.addEventListener('keydown', onErrorPopupEscKeydown);\n  errorButton.addEventListener('click', onErrorButtonClick);\n};\n\nresetFormBtn.addEventListener('click', (evt) => {\n  evt.preventDefault();\n  resetForm();\n})\n\nadForm.addEventListener('submit', (evt) => {\n  evt.preventDefault();\n  const data = new FormData(evt.target);\n  sendData(URL_SERVER, showSuccess, showError, data)\n});\n\nloadImg(avatarFileChooser, avatarPreview);\nloadImg(imgFileChoicer, imgPreview);\n"],"sourceRoot":""}